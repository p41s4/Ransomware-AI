# Ransomware Threat Intelligence Pipeline (n8n)

This project implements an **automated ransomware Threat Intelligence pipeline** using **n8n** as the orchestration engine.  
The workflow aggregates data from multiple public and private sources to produce a **unified intelligence object** and generate a **strict, traceable analytical report** using an LLM-based agent.
See "output.txt" to check the quality of the reports you can generate with this pipeline. 

---

## Project Objective

- Collect dispersed information related to **ransomware groups**
- Normalize and correlate technical, financial, and operational data
- Consolidate negotiations and ransom notes
- Produce a **Threat Intelligence Report** with no inference or external enrichment

---

## High-Level Architecture
  
<img width="2183" height="857" alt="image" src="https://github.com/user-attachments/assets/1d27d3a9-a05b-4d4f-91e8-18c4dba96fd6" />

**Input:**  
- Ransomware group name (via chat / webhook trigger)

**Data Sources:**
- ransomware.live (public and PRO APIs)
- ransomlook.io
- Malpedia (actors and synonyms)
- Negotiations and ransom notes (ransomware.live PRO)

**Output:**
- Unified Threat Intelligence JSON object
- Structured analytical report generated by an LLM agent

---

## Data Flow Overview

1. **Trigger**
   - `When chat message received`
   - Receives the ransomware group name as input

2. **External Enrichment**
   - Group metadata (ransomware.live, ransomlook)
   - Actor synonyms and profiles (Malpedia)
   - Observed infrastructure
   - Ransom note names and full contents
   - Negotiation IDs and full chat transcripts

3. **Normalization and Correlation**
   - `Code in JavaScript` node
   - Merges all collected data into a single coherent object

4. **AI-Assisted Analysis**
   - LLM agent operating under strict rules
   - Generates a report without assumptions or inference

---

## Key Workflow Components

### 1. Core Normalization Logic (`Code in JavaScript`)

This node is the **core of the project** and performs:

#### Actor
- Primary name
- Aliases and synonyms
- External references
- Metadata and confidence (if present)

#### MITRE ATT&CK
- Valid tactics and techniques only (Txxxx / Txxxx.xxx)
- Deduplication across sources
- Multi-source consolidation

#### Infrastructure
- FQDNs
- Type (e.g., DLS, negotiation chat)
- Availability status
- HTTP metadata and fingerprints

#### Tooling
- Tools explicitly associated with the actor
- No inferred categorization

#### Financial Indicators
- Observed Bitcoin addresses

#### Ransomware
- File extensions
- Leak site URL
- Parser
- Ransom notes (supports multiple schemas)

#### Extortion
- Chats grouped by `chat_id`
- Initial vs negotiated ransom
- Message deduplication
- Payment metadata when available

---

### 2. Robust Ransom Note Handling

The workflow supports multiple input formats:

- Root object as a note
- `notes[]`
- `ransom_notes[]`
- `note`
- `readme`
- `files[]` containing textual content

All ransom notes are:
- Normalized
- Deduplicated
- Preserved verbatim (no preprocessing or interpretation)

---

### 3. Negotiation Data Processing

- Retrieval of negotiation IDs
- Collection of full negotiation chats
- Grouping per victim / negotiation
- Prepared for quantitative and qualitative analysis

---

## LLM Intelligence Agent

The AI agent operates in **strict analytical mode** with the following constraints:

- No inference or speculation
- No external knowledge enrichment
- No assumptions
- Every statement must be traceable to JSON fields
- Missing data is explicitly stated as such

### Final Report Sections

1. Threat Actor Identification
2. Summary
3. Observed Operative Model and Capabilities
4. MITRE ATT&CK TTPs
5. Tooling
6. Observed Infrastructure
7. Financial Indicators
8. Ransom Notes (verbatim text only)
9. Extortion Analysis
   - Initial vs negotiated ransom comparison
   - Average discount calculation
   - Pressure techniques based strictly on attacker messages
10. Analysis Limitations

---

## Requirements

- n8n (>= v1.x)
- HTTP credentials for:
  - ransomware.live PRO API
- OpenAI API key (GPT-4 class model)

---

## Usage

1. Import the workflow JSON into n8n
2. Configure HTTP and OpenAI credentials
3. Submit a ransomware group name as input
4. Receive:
   - A consolidated Threat Intelligence JSON object
   - A structured analytical report

---

## Limitations

- No attribution analysis
- No campaign, sector, or geographic inference
- No validation of external source accuracy
- Output quality depends strictly on available data

---

## License

Internal use / research purposes.  
Review third-party API terms before production deployment.

---

## Author

Designed for professional **Threat Intelligence, DFIR, and ransomware analysis** use cases.
